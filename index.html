<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study me as much as you like, you will not know me</title>
    <style>
        :root {
            --sky-color: #001122;
            --sun-left: 0%;
            --sun-bottom: -200px;
            --sun-color: #ff3300;
            --sun-opacity: 0;
            --moon-left: 0%;
            --moon-bottom: -200px;
            --moon-opacity: 0;
            --ground-color: #000000;
        }

        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            background-color: #000;
        }

        .sky {
            width: 100%;
            height: 100vh;
            background-color: var(--sky-color);
            transition: background-color 6s ease-in-out;
            position: relative;
        }

        /* Sun Styles */
        #sun-link {
            position: absolute;
            left: var(--sun-left);
            bottom: var(--sun-bottom);
            transform: translateX(-50%);
            z-index: 5;
            pointer-events: none;
            cursor: pointer;
            transition: bottom 10s cubic-bezier(0.22, 1, 0.36, 1), 
                        left 10s cubic-bezier(0.22, 1, 0.36, 1);
        }

        .sun {
            width: 115px;
            height: 115px;
            background-color: var(--sun-color);
            border-radius: 50%;
            opacity: var(--sun-opacity);
            box-shadow: 0 0 80px var(--sun-color);
            transition: background-color 5s ease, opacity 4s ease;
        }

        /* Moon Styles */
        #moon-link {
            position: absolute;
            width: 120px;
            height: 120px;
            left: var(--moon-left);
            bottom: var(--moon-bottom);
            opacity: var(--moon-opacity);
            transform: translateX(-50%);
            z-index: 5;
            pointer-events: none;
            cursor: pointer;
            transition: bottom 10s ease-out, left 10s ease-out, opacity 2s;
            filter: drop-shadow(0 0 25px rgba(255, 255, 255, 0.5));
        }

        .moon-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: opacity 0.3s ease;
        }

        .horizon {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 20vh;
            background-color: var(--ground-color);
            background-image: linear-gradient(to bottom, transparent 0%, rgba(0,0,0,0.8) 100%);
            z-index: 10;
            transition: background-color 8s ease-in-out;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }
    </style>
</head>
<body>

    <div class="sky" id="sky">
        <a href="sloka.html" id="sun-link">
            <div class="sun"></div>
        </a>
        
        <a href="https://www.youtube.com/watch?v=Y5YKzTWU0Ng" id="moon-link">
            <img id="moon-image" class="moon-image" alt="Moon Phase">
        </a>
        
        <div class="horizon"></div>
    </div>

    <script>
        const LOCAL_IMAGE_PATH = "moon-phases-cropped/moon-";

        function getMoonPhase(date) {
            const knownNewMoon = new Date('2000-01-06 18:14:00 UTC');
            const lunarCycle = 29.53058867;
            
            const diff = date - knownNewMoon;
            const days = diff / (1000 * 60 * 60 * 24);
            const phase = (days % lunarCycle) / lunarCycle;
            
            return phase;
        }

        function getMoonImageUrl(phase) {
            // Map phase (0-1) to day number (0-29)
            const dayOfCycle = Math.floor(phase * 30);
            const paddedDay = String(dayOfCycle).padStart(2, '0');
            return `${LOCAL_IMAGE_PATH}${paddedDay}.png`;
        }

        function updateEnvironment() {
            const now = new Date();
            const totalMins = (now.getHours() * 60) + now.getMinutes();
            
            // Sky color logic
            const dayPercent = (totalMins / 1440) * 100;
            let skyColor = "#001122";
            if (dayPercent > 10) skyColor = "#3a506b";
            if (dayPercent > 25) skyColor = "#87CEEB";
            if (dayPercent > 50) skyColor = "#4da6ff";
            if (dayPercent > 70) skyColor = "#ff8c00";
            if (dayPercent > 85) skyColor = "#2c3e50";
            if (dayPercent > 95) skyColor = "#000814";
            document.documentElement.style.setProperty('--sky-color', skyColor);

            const sunrise = 360;  // 6:00 AM
            const sunset = 1140;  // 7:00 PM
            const sunLink = document.getElementById('sun-link');
            const moonLink = document.getElementById('moon-link');

            if (totalMins >= sunrise && totalMins <= sunset) {
                // DAYTIME - Show Sun
                const x = (totalMins - sunrise) / (sunset - sunrise);
                const heightFactor = -4 * Math.pow(x, 2) + (4 * x);
                
                const leftPos = 10 + (x * 80);
                const bottomPos = (heightFactor * 55) + 15;

                const g = Math.floor(60 + (195 * heightFactor));
                const b = Math.floor(180 * Math.pow(heightFactor, 3));
                
                // Ground color
                const baseR = 40, baseG = 25, baseB = 10;
                const targetR = 46, targetG = 204, targetB = 113;
                const gr = Math.floor(baseR + (targetR - baseR) * heightFactor);
                const gg = Math.floor(baseG + (targetG - baseG) * heightFactor);
                const gb = Math.floor(baseB + (targetB - baseB) * heightFactor);

                document.documentElement.style.setProperty('--sun-left', leftPos + "%");
                document.documentElement.style.setProperty('--sun-bottom', bottomPos + "%");
                document.documentElement.style.setProperty('--sun-opacity', "1");
                document.documentElement.style.setProperty('--sun-color', `rgb(255, ${g}, ${b})`);
                document.documentElement.style.setProperty('--ground-color', `rgb(${gr}, ${gg}, ${gb})`);
                
                // Hide moon during day
                document.documentElement.style.setProperty('--moon-opacity', "0");
                moonLink.style.pointerEvents = "none";

                setTimeout(() => { sunLink.style.pointerEvents = "auto"; }, 8000);
            } else {
                // NIGHTTIME - Show Moon
                document.documentElement.style.setProperty('--sun-opacity', "0");
                document.documentElement.style.setProperty('--ground-color', "#000000");
                sunLink.style.pointerEvents = "none";

                // Calculate moon position
                let nightProgress;
                if (totalMins > sunset) {
                    nightProgress = (totalMins - sunset) / (1440 - sunset + sunrise);
                } else {
                    nightProgress = (totalMins + (1440 - sunset)) / (1440 - sunset + sunrise);
                }
                
                const moonHeight = -4 * Math.pow(nightProgress, 2) + (4 * nightProgress);
                const moonLeft = 10 + (nightProgress * 80);
                const moonBottom = (moonHeight * 60) + 15;

                document.documentElement.style.setProperty('--moon-left', moonLeft + "%");
                document.documentElement.style.setProperty('--moon-bottom', moonBottom + "%");
                document.documentElement.style.setProperty('--moon-opacity', "1");

                // Calculate moon phase
                const phase = getMoonPhase(now);
                
                // Update moon image
                const moonImg = document.getElementById('moon-image');
                const imageUrl = getMoonImageUrl(phase);
                
                if (moonImg.src !== imageUrl) {
                    moonImg.src = imageUrl;
                }

                setTimeout(() => { moonLink.style.pointerEvents = "auto"; }, 8000);
            }
        }

        window.onload = updateEnvironment;
        setInterval(updateEnvironment, 60000); // Update every minute
    </script>
</body>
</html>

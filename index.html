<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Beginnings</title>
    <style>
        :root {
            --sky-color: #001122;
            --sun-left: 0%;
            --sun-bottom: -200px;
            --sun-color: #ff3300;
            --sun-opacity: 0;
            /* Start ground as absolute black */
            --ground-color: #000000; 
        }

        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            background-color: #000;
        }

        .sky {
            width: 100%;
            height: 100vh;
            background-color: var(--sky-color);
            transition: background-color 6s ease-in-out;
            position: relative;
        }

        #sun-link {
            position: absolute;
            left: var(--sun-left);
            bottom: var(--sun-bottom);
            transform: translateX(-50%);
            z-index: 5;
            pointer-events: none;
            cursor: pointer;
            /* 10-second glide into position */
            transition: bottom 10s cubic-bezier(0.22, 1, 0.36, 1), 
                        left 10s cubic-bezier(0.22, 1, 0.36, 1);
        }

        .sun {
            width: 115px;
            height: 115px;
            background-color: var(--sun-color);
            border-radius: 50%;
            opacity: var(--sun-opacity);
            box-shadow: 0 0 80px var(--sun-color);
            transition: background-color 5s ease, opacity 4s ease;
        }

        .horizon {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 20vh;
            /* We use background-color for the transition and a gradient overlay for depth */
            background-color: var(--ground-color);
            background-image: linear-gradient(to bottom, transparent 0%, rgba(0,0,0,0.8) 100%);
            z-index: 10;
            transition: background-color 8s ease-in-out;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }
    </style>
</head>
<body>

    <div class="sky" id="sky">
        <a href="sloka.html" id="sun-link">
            <div class="sun"></div>
        </a>
        <div class="horizon"></div>
    </div>

    <script>
        function updateEnvironment() {
            const now = new Date();
            const totalMins = (now.getHours() * 60) + now.getMinutes();
            
            // 1. SKY COLOR LOGIC
            const dayPercent = (totalMins / 1440) * 100;
            let skyColor = "#001122";
            if (dayPercent > 10) skyColor = "#3a506b";
            if (dayPercent > 25) skyColor = "#87CEEB";
            if (dayPercent > 50) skyColor = "#4da6ff";
            if (dayPercent > 70) skyColor = "#ff8c00";
            if (dayPercent > 85) skyColor = "#2c3e50";
            if (dayPercent > 95) skyColor = "#000814";
            document.documentElement.style.setProperty('--sky-color', skyColor);

            // 2. SUN & GROUND (6:00 AM to 7:00 PM Window)
            const sunrise = 360; 
            const sunset = 1140; 
            const sunLink = document.getElementById('sun-link');

            if (totalMins >= sunrise && totalMins <= sunset) {
                const x = (totalMins - sunrise) / (sunset - sunrise);
                const heightFactor = -4 * Math.pow(x, 2) + (4 * x); // 0 at dawn, 1 at noon
                
                const leftPos = 10 + (x * 80);
                const bottomPos = (heightFactor * 55) + 15;

                // Sun Color
                const g = Math.floor(60 + (195 * heightFactor));
                const b = Math.floor(180 * Math.pow(heightFactor, 3));
                
                // GROUND COLOR LOGIC (Dynamic RGB)
                // At x=0 (Dawn): HeightFactor is 0. Ground should be Dark Brownish.
                // At x=0.5 (Noon): HeightFactor is 1. Ground should be Vibrant Green.
                
                let gr, gg, gb;
                // Base earth color (dark brown)
                const baseR = 40, baseG = 25, baseB = 10;
                // Target green color (grass green: 46, 204, 113)
                const targetR = 46, targetG = 204, targetB = 113;

                // Interpolate between dark brown and grass green based on heightFactor
                gr = Math.floor(baseR + (targetR - baseR) * heightFactor);
                gg = Math.floor(baseG + (targetG - baseG) * heightFactor);
                gb = Math.floor(baseB + (targetB - baseB) * heightFactor);

                document.documentElement.style.setProperty('--sun-left', leftPos + "%");
                document.documentElement.style.setProperty('--sun-bottom', bottomPos + "%");
                document.documentElement.style.setProperty('--sun-opacity', "1");
                document.documentElement.style.setProperty('--sun-color', `rgb(255, ${g}, ${b})`);
                document.documentElement.style.setProperty('--ground-color', `rgb(${gr}, ${gg}, ${gb})`);

                setTimeout(() => { sunLink.style.pointerEvents = "auto"; }, 10000);
            } else {
                // Night Phase
                document.documentElement.style.setProperty('--sun-opacity', "0");
                document.documentElement.style.setProperty('--ground-color', "#000000");
                sunLink.style.pointerEvents = "none";
            }
        }

        window.onload = updateEnvironment;
        setInterval(updateEnvironment, 60000);
    </script>
</body>
</html>
